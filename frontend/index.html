<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/styles.css" />
    <title>Chat Nhanh</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/phosphor-icons"></script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <span style="display: flex; align-items: center; gap: 8px">
          <svg width="28" height="28" fill="#5b6be1" viewBox="0 0 24 24">
            <path
              d="M12 2C6.477 2 2 6.037 2 11c0 2.386 1.053 4.553 2.805 6.207-.13.627-.527 2.52-1.13 4.08a.5.5 0 0 0 .65.65c1.56-.603 3.453-1 4.08-1.13C7.447 20.947 9.614 22 12 22c5.523 0 10-4.037 10-9s-4.477-9-10-9Z"
            />
          </svg>
          Chat Nhanh
        </span>
        <div style="display: flex; align-items: center; gap: 12px;">
          <img id="avatarImg" src="/default-avatar.png" alt="avatar" style="width:32px;height:32px;border-radius:50%;object-fit:cover;border:1.5px solid #5b6be1;" />
          <input type="file" id="avatarInput" accept="image/*" style="display:none;" />
          <button id="profileBtn" style="background: none; border: none; cursor: pointer; margin-left: 0;">
            <svg width="28" height="28" fill="#5b6be1" viewBox="0 0 24 24">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
          </button>
        </div>
        <!-- Đã xóa các icon góc trên bên phải -->
      </div>
      <div class="main-content">
        <div class="sidebar">
          <div
            class="sidebar-header"
            style="
              padding: 24px 24px 0 24px;
              font-size: 20px;
              font-weight: 700;
              color: #5b6be1;
            "
          >
            Chat Nhanh
          </div>
          <div
            class="sidebar-greeting"
            style="padding: 0 24px 12px 24px; color: #888; font-size: 15px"
          >
            Chào mừng bạn đến với Chat Nhanh! Hãy nhập tên của bạn để bắt đầu.
          </div>
          <div
            class="sidebar-tabs"
            style="
              display: flex;
              border-bottom: 1px solid #e5e7eb;
              margin: 0 24px 8px 24px;
            "
          >
            <button
              class="sidebar-tab active"
              style="
                flex: 1;
                text-align: center;
                padding: 10px 0 8px 0;
                font-size: 15px;
                color: #5b6be1;
                background: none;
                border: none;
                border-radius: 12px 12px 0 0;
              "
            >
              Bạn bè
            </button>
            <button
                class="sidebar-tab"
                id="onlineTabBtn"
                style="
                  flex: 1;
                  text-align: center;
                  padding: 10px 0 8px 0;
                  font-size: 15px;
                  color: #5b6be1;
                  background: none;
                  border: none;
                  border-radius: 12px 12px 0 0;
                  position: relative;
                "
              >
                Online <span id="onlineTabCount" style="font-weight:600; color:#5b6be1;">(0)</span>
              </button>
            <button
              class="sidebar-tab"
              style="
                flex: 1;
                text-align: center;
                padding: 10px 0 8px 0;
                font-size: 15px;
                color: #5b6be1;
                background: none;
                border: none;
                border-radius: 12px 12px 0 0;
              "
            >
              Phòng
            </button>
          </div>
          <div class="search-box" style="padding: 0 24px 16px 24px">
            <input
              type="text"
              class="search-input"
              placeholder="Tìm bạn bằng email..."
              style="
                width: calc(100% - 40px);
                padding: 10px 14px;
                border-radius: 12px;
                border: 1px solid #e5e7eb;
                font-size: 15px;
              "
            />
            <button
              class="search-btn"
              style="
                background: #5b6be1;
                color: #fff;
                border: none;
                border-radius: 12px;
                width: 32px;
                height: 32px;
                margin-left: 8px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: background 0.2s;
              "
            >
              <svg
                width="18"
                height="18"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 4a8 8 0 1 1 0 16 8 8 0 0 1 0-16zm0 14a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm7-1.41-3.87-3.87A5.98 5.98 0 0 0 18 12a6 6 0 1 0-6 6c1.31 0 2.53-.42 3.54-1.13l3.87 3.87a1 1 0 0 0 1.41-1.41z"
                ></path>
              </svg>
            </button>
          </div>
          <div
            class="friend-section"
            id="friendSection"
            style="display: none; padding: 0 24px"
          >
            <ul
              class="friend-list"
              id="friendList"
              style="list-style: none; padding: 0; margin: 0"
            >
              <!-- Không có user mẫu, sẽ render động nếu có dữ liệu -->
            </ul>
          </div>
          <div class="invite-section" style="padding: 0 24px 16px 24px">
            <div class="invite-title" style="font-weight: 600; color: #5b6be1">
              Lời mời kết bạn (0)
            </div>
            <div class="invite-empty" style="color: #888; font-size: 15px">
              Không có lời mời nào
            </div>
          </div>
          <div
            class="sidebar-settings"
            style="position: absolute; bottom: 24px; left: 24px"
          >
            <button
              style="
                background: #5b6be1;
                color: #fff;
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
                cursor: pointer;
                transition: background 0.2s;
              "
            >
              <svg
                width="22"
                height="22"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 15.5A3.5 3.5 0 1 1 12 8.5a3.5 3.5 0 0 1 0 7zm7.43-2.88-.94-.32a7.03 7.03 0 0 0-.37-1.01l.6-.8a.5.5 0 0 0-.06-.66l-1.42-1.42a.5.5 0 0 0-.66-.06l-.8.6c-.32-.13-.65-.24-1.01-.37l-.32-.94A.5.5 0 0 0 15 7h-2a.5.5 0 0 0-.5.41l-.32.94c-.36.13-.69.24-1.01.37l-.8-.6a.5.5 0 0 0-.66.06L7.41 9.41a.5.5 0 0 0-.06.66l.6.8c-.13.32-.24.65-.37 1.01l-.94.32A.5.5 0 0 0 5 13v2c0 .22.14.41.34.48l.94.32c.13.36.24.69.37 1.01l-.6.8a.5.5 0 0 0 .06.66l1.42 1.42a.5.5 0 0 0 .66.06l.8-.6c.32.13.65.24 1.01.37l.32.94A.5.5 0 0 0 9 17h2c.22 0 .41-.14.48-.34l.32-.94c.36-.13.69-.24 1.01-.37l.8.6a.5.5 0 0 0 .66-.06l1.42-1.42a.5.5 0 0 0 .06-.66l-.6-.8c.13-.32.24-.65.37-1.01l.94-.32A.5.5 0 0 0 19 15v-2c0-.22-.14-.41-.34-.48z"
                ></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="chat-area">
          <div class="chat-header">
              <span style="display: flex; align-items: center; gap: 8px;">
                <svg width="22" height="22" fill="#5b6be1" viewBox="0 0 24 24">
                  <path d="M17 10c1.654 0 3 1.346 3 3s-1.346 3-3 3c-.342 0-.676-.057-.995-.166C15.999 16.112 16 16.056 16 16c0-1.654-1.346-3-3-3-.056 0-.112.001-.166.005C12.057 13.324 12 13.658 12 14c0 1.654-1.346 3-3 3s-3-1.346-3-3c0-.342.057-.676.166-.995C7.888 13.999 7.944 14 8 14c1.654 0 3-1.346 3-3 0-.056-.001-.112-.005-.166C10.676 10.057 10.342 10 10 10c-1.654 0-3 1.346-3 3 0 .342.057.676.166.995C6.001 13.944 6 13.888 6 13.832V13c0-1.654 1.346-3 3-3 .342 0 .676.057.995.166C9.999 9.888 10 9.944 10 10c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 12.676 14 12.342 14 12c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 8.888 10 8.944 10 9c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 11.676 14 11.342 14 11c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 7.888 10 7.944 10 8c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 10.676 14 10.342 14 10c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 6.888 10 6.944 10 7c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 9.676 14 9.342 14 9c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 5.888 10 5.944 10 6c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 8.676 14 8.342 14 8c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 4.888 10 4.944 10 5c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 7.676 14 7.342 14 7c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 3.888 10 3.944 10 4c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 6.676 14 6.342 14 6c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 2.888 10 2.944 10 3c0 1.654 1.346 3 3 3 .056 0 .112-.001.166-.005C13.943 5.676 14 5.342 14 5c0-1.654-1.346-3-3-3-.342 0-.676.057-.995.166C10.001 1.888 10 1.944 10 2c0 1.654 1.346 3 3 3z" />
                </svg>
                <span style="font-size: 20px; color: #222; font-weight: 600;">Phòng Chat all</span>
              </span>
          </div>
          <div class="chat-box" style="height: calc(100vh - 160px); width: 100%; display: flex; flex-direction: column; justify-content: flex-end;">
            <input id="usernameInput" placeholder="Tên bạn" style="margin-bottom: 8px; display: none;" />
            <ul
              id="messages"
              style="
                width: 100%;
                height: 100%;
                max-height: 100%;
                overflow-y: auto;
                padding: 24px 24px 5px 24px;
                display: flex;
                flex-direction: column;
                gap: 8px;
              "
            ></ul>
          </div>
          <form
            class="chat-input-area"
            autocomplete="off"
            onsubmit="sendMessage(); return false;"
          >
            <input
              id="messageInput"
              type="text"
              class="message-input"
              placeholder="Nhập tin nhắn của bạn..."
            />
            <button class="send-button" type="submit">
              <span class="ph-paper-plane-tilt"></span>
            </button>
          </form>
        </div>
      </div>
    </div>
  <!-- Modal nhập tên và cập nhật avatar -->
    <div
      id="profileModal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.2);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          background: #fff;
          padding: 32px 24px;
          border-radius: 12px;
          box-shadow: 0 2px 16px rgba(0, 0, 0, 0.12);
          min-width: 320px;
          max-width: 90vw;
          margin: auto;
          display: flex;
          flex-direction: column;
          gap: 16px;
          align-items: center;
        "
      >
        <h3>Nhập tên của bạn</h3>
        <img id="modalAvatarImg" src="/default-avatar.png" alt="avatar" style="width:64px;height:64px;border-radius:50%;object-fit:cover;border:1.5px solid #5b6be1;margin-bottom:8px;" />
        <button id="changeAvatarBtn" style="background:#eee;color:#222;padding:6px 16px;border:none;border-radius:8px;font-size:15px;cursor:pointer;margin-bottom:8px;">Cập nhật avatar</button>
        <input id="profileNameInput" type="text" placeholder="Tên của bạn" style="padding: 10px 16px; border-radius: 8px; border: 1px solid #e5e7eb; width: 100%; font-size: 16px;" />
        <div style="display: flex; gap: 12px; margin-top: 8px">
          <button id="saveProfileBtn" style="background: #5b6be1; color: #fff; padding: 8px 20px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">Lưu</button>
          <button id="closeProfileBtn" style="background: #eee; color: #222; padding: 8px 20px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">Đóng</button>
        </div>
      </div>
    </div>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="/index.js"></script>
  </body>
</html>
